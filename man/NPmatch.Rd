% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/NPmatch.R
\name{NPmatch}
\alias{NPmatch}
\title{Batch correction with NPmatch}
\usage{
NPmatch(
  X,
  y,
  dist.method = "cor",
  center.x = TRUE,
  center.m = TRUE,
  knn = 1,
  sdtop = 2000,
  return.B = FALSE,
  use.design = TRUE,
  use.cov = FALSE
)
}
\arguments{
\item{X}{Normalized data matrix: features/genes in rows; samples in columns}

\item{y}{Factor vector indicating batch for each sample}

\item{dist.method}{Distance metric to use for matching ('cor' or 'euclidean')}

\item{center.x}{Logical for whether to center gene expression by row means}

\item{center.m}{Logical for whether to center expression by batch means}

\item{knn}{k nearest neighbor to be determined for each sample in each group}

\item{sdtop}{Number of top variable genes to use}

\item{return.B}{Logical for whether returing the full set of pairs along with the corrected data matrix}

\item{use.design}{Logical for whether using Limma's design matrix}

\item{use.cov}{Logical for whether using a scaled model matrix of the full pairs}
}
\value{
If \code{return.B = FALSE} (default), returns a batch-corrected expression matrix
  with the same dimensions as the input matrix X. If \code{return.B = TRUE}, returns a list
  containing two elements:
  \itemize{
    \item \code{X}: The batch-corrected expression matrix
    \item \code{pairings}: A matrix showing the nearest neighbor pairings used for batch correction,
          with samples as rows and batch groups as columns
  }
  The batch correction is performed using nearest neighbor matching followed by removal of
  pairing effects while preserving biological differences between conditions.
}
\description{
Batch correction with NPmatch
}
\examples{
# Load the example dataset provided and run:
data(GSE10846.Expression, package = "NPmatch")
data(GSE10846.Metadata, package = "NPM")
nX <- normalize.log2CPM(GSE10846.Expression)
nX <- limma::normalizeQuantiles(nX)
y <- GSE10846.Metadata[colnames(nX), "dlbcl.type"]
cX <- NPmatch(nX, y)

}
